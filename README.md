# Image Forensics OSN

An official implementation code for paper "Robust Image Forgery Detection against Transmission over Online Social Networks"

## Table of Contents

- [Background](#background)
- [Dependency](#dependency)
- [Usage](#usage)
- [Acknowledgments](#acknowledgments)


## Background

The increasing abuse of image editing software causes the authenticity of digital images questionable. Meanwhile, the widespread availability of online social networks (OSNs) makes them the dominant channels for transmitting forged images to report fake news, propagate rumors, etc. Unfortunately, various lossy operations, e.g., compression and resizing, adopted by OSNs impose great challenges for implementing robust image forgery detection, as shown in the below figure.

<p align='center'>  
  <img src='https://github.com/HighwayWu/ImageForensicsOSN/blob/main/imgs/demo.jpg' width='550'/>
</p>
<p align='center'>  
  <em>The detection results of DFCN (TIFS 2021) and ours by using an original forgery and the forgery transmitted through OSN. The right woman in the forgery is spliced (forged).</em>
</p>

To fight against the OSN-shared forgeries, in this work, a novel robust training scheme is proposed. Firstly, we design a baseline detector, which won top ranking in a recent certificate forgery detection competition. Then we conduct a thorough analysis of the noise introduced by OSNs, and decouple it into two parts, i.e., *predictable noise* and *unseen noise*, which are modelled separately. The former simulates the noise introduced by the disclosed (known) operations of OSNs, while the latter is designed to not only complete the previous one, but also take into account the defects of the detector itself. We finally incorporate the modelled noise into a robust training framework, significantly improving the robustness of the image forgery detector.

<p align='center'>
  <img src='https://github.com/HighwayWu/ImageForensicsOSN/blob/main/imgs/framework.jpg' width='770'/>
</p>
<p align='center'>  
  <em>The overview of our proposed training scheme and corresponding testing phase.</em>
</p>

<p align='center'>
  <img src='https://github.com/HighwayWu/ImageForensicsOSN/blob/main/imgs/cmp.jpg' width='770'/>
</p>
<p align='center'>  
  <em>A qualitative comparison for the detection of OSN-transmitted forgeries. For each row, the images from left to right are forgery (input), ground-truth, detection result (output) generated by MT-Net (CVPR 2019), NoiPri (TIFS 2020), ForSim (TIFS 2020), DFCN (TIFS 2021) and ours, respectively. The forgeries in each group from top to bottom are the cases without OSN transmission, and with Facebook, Weibo and Wechat transmissions, respectively.</em>
</p>

Furthermore, we build a public forgeries dataset based on four existing datasets, through uploading and downloading over the platforms of Facebook, Weibo, and Wechat, respectively. The collected datasets will be made available soon, serving as a useful resource to our research community for fighting against the OSN-transmitted forgeries.

## Dependency

- torch 1.6.0
- tensorflow 1.8.0

## Usage

For testing:
```bash
python test.py
```
Then the model will detect the images in the `data/input/` and save the results in the `data/output/` directory.

**Note 1: Download the pretrained model from [here](https://drive.google.com/file/d/1rq0GNL0AiwlzEIpEshhJTRjl9n6arZvN/view?usp=sharing) and put in the 'weights/' directory.**

## Acknowledgments
- Part of the network codes are based on the [SCSE-U-Net](https://github.com/maloyan/Roscosmos)
- The [Tianchi Competition](https://tianchi.aliyun.com/competition/entrance/531812/introduction)
